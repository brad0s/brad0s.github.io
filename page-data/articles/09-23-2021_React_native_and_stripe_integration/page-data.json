{
    "componentChunkName": "component---src-templates-blog-post-js",
    "path": "/articles/09-23-2021_React_native_and_stripe_integration/",
    "result": {"data":{"site":{"siteMetadata":{"title":"Brados Blogs"}},"markdownRemark":{"id":"2dc7263f-d78d-54a7-a1df-25f2dc5d1402","excerpt":"This is a how-to on integrating stripe with a react native app. I recently tried this out and learned some things along the way. Hopefully, this will help youâ€¦","html":"<p>This is a how-to on integrating stripe with a react native app. I recently tried this out and learned some things along the way. Hopefully, this will help you guys integrate it and not leave you confused as I was while I was trying to figure it out.</p>\n<p><a href=\"https://stripe.com/docs\">Stripe</a> is a SaaS that offers an easy to plugin way to accept payments to your app/website. Stripe allows you to user their software to accept payments and grow your business without the overhead of managing all of that on your own.</p>\n<p>Letâ€™s get to it ðŸ¤Ÿ</p>\n<h2>Create a stripe account</h2>\n<p>In order to use stripe in our application, we will need to create an account with them so that we have the required access keys needed.</p>\n<p>Go to <a href=\"https://dashboard.stripe.com/register\">https://dashboard.stripe.com/register</a> to create an account. Next, you need to get your private keys. From the dashboard, you can click on Developers in the upper right part of the screen, then click on API Keys on the left side of the screen. You will now see a publishable key and secret key. You will need these later.</p>\n<h2>Installation</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ npx react-native init stripeExample</code></pre></div>\n<p>We need to install some packages first to help get us started. Iâ€™ll breeze through this part. If you have trouble refer to the documentation. <code class=\"language-text\">cd</code> into the project folder and letâ€™s install these packages.</p>\n<h3>navigation</h3>\n<p>These will be used for basic navigation. Refer to the <a href=\"https://reactnavigation.org/docs/getting-started/\">react-navigation docs</a></p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ yarn add @react-navigation/native react-native-screens react-native-safe-area-context @react-navigation/native-stack</code></pre></div>\n<p>run <code class=\"language-text\">pod install</code> in <code class=\"language-text\">ios</code> directory</p>\n<h3>stripe</h3>\n<p><a href=\"https://github.com/stripe/stripe-react-native\">React native stripe docs</a></p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">yarn add @stripe/stripe-react-native</code></pre></div>\n<p>run <code class=\"language-text\">pod install</code> in <code class=\"language-text\">ios</code> directory</p>\n<h5>trouble shooting ios errors</h5>\n<h6>errors after installing with npm</h6>\n<p>If you were to build your app now, you would get some errors. We need to make some changes in ios to fix these errors. Open <code class=\"language-text\">stripeExample.xcworkspace</code> in xcode and and go to Build Settings and set â€˜iOS Deployment Targetâ€™ to iOS 11.0.</p>\n<p>Now open <code class=\"language-text\">podfile</code> and update line 4 to read <code class=\"language-text\">platform :ios, '11.0'</code>.</p>\n<h6>errors with x86_64 mac</h6>\n<p>If youâ€™re still getting an error you can reference this <a href=\"https://github.com/stripe/stripe-react-native/#undefined-symbols-for-architecture-x86_64-on-ios\">fix</a> to resolve the error.\nThe steps to fix are listed below:</p>\n<blockquote>\n<p>Open your project via Xcode, go to project -> build settings, find library search paths and remove all swift related entries such as: $(TOOLCHAIN_DIR)/usr/lib/swift/$(PLATFORM_NAME) and $(TOOLCHAIN_DIR)/usr/lib/swift-5.0/$(PLATFORM_NAME).</p>\n<p>Create a new Swift file to the project (File > New > File > Swift), give it any name (e.g. Fix.swift) and create a bridging header when prompted by Xcode.</p>\n</blockquote>\n<h6>RCTBridge error</h6>\n<p>If you encouter some sort of RTCBridge error, you will need to make some changes to your ios code. The changes below fixed the problem for me. You can refer to this <a href=\"https://github.com/facebook/react-native/issues/16376#issuecomment-810094592\">issue</a> on github if it doesnâ€™t work for you.</p>\n<p>AppDelegate.h</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">#import \"AppDelegate.h\"\n// NEW CODE\n\n#if RCT_DEV\n#import &lt;React/RCTDevLoadingView.h>\n#endif\n\n// END</code></pre></div>\n<p>AppDelegate.m</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions\n{\n  RCTBridge *bridge = [[RCTBridge alloc] initWithDelegate:self launchOptions:launchOptions];\n  // NEW CODE\n\n  #if RCT_DEV\n   [bridge moduleForClass:[RCTDevLoadingView class]];\n  #endif\n\n  // END\n\n  RCTRootView *rootView = [[RCTRootView alloc] initWithBridge:bridge\n                                                   moduleName:@\"TempleWallet\"\n                                            initialProperties:nil];\n  ...</code></pre></div>\n<p>Now letâ€™s run our app. You should be able to build the app successfully at this point. ðŸ¤“</p>\n<p><code class=\"language-text\">$ react-native run-ios</code></p>\n<h2>Building the app</h2>\n<p>Now that weâ€™ve got all the set-up and installation out the way we can start building out the app.<br>\nLetâ€™s start by creating a simple home screen that will have a button that we can press to initiate the payment process. At the root of the project create <code class=\"language-text\">src > screens > HomeScreen.js</code>.<br>\nCopy and past this into <code class=\"language-text\">HomeScreen.js</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// HomeScreen.js</span>\n<span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">\"react\"</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> View<span class=\"token punctuation\">,</span> Text<span class=\"token punctuation\">,</span> StatusBar<span class=\"token punctuation\">,</span> Pressable<span class=\"token punctuation\">,</span> StyleSheet <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"react-native\"</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">function</span> <span class=\"token function\">HomeScreen</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span>View style<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>styles<span class=\"token punctuation\">.</span>container<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>StatusBar barStyle<span class=\"token operator\">=</span><span class=\"token string\">\"light-content\"</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>Pressable\n        style<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>styles<span class=\"token punctuation\">.</span>button<span class=\"token punctuation\">}</span>\n        onPress<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Todo: Navigate to payment screen\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span>\n      <span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>Text style<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>styles<span class=\"token punctuation\">.</span>label<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>Buy<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Text<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Pressable<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>View<span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> styles <span class=\"token operator\">=</span> StyleSheet<span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  container<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    flex<span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n    alignItems<span class=\"token operator\">:</span> <span class=\"token string\">\"center\"</span><span class=\"token punctuation\">,</span>\n    justifyContent<span class=\"token operator\">:</span> <span class=\"token string\">\"center\"</span><span class=\"token punctuation\">,</span>\n    backgroundColor<span class=\"token operator\">:</span> <span class=\"token string\">\"#141414\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  button<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    borderRadius<span class=\"token operator\">:</span> <span class=\"token number\">8</span><span class=\"token punctuation\">,</span>\n    width<span class=\"token operator\">:</span> <span class=\"token number\">150</span><span class=\"token punctuation\">,</span>\n    padding<span class=\"token operator\">:</span> <span class=\"token number\">8</span><span class=\"token punctuation\">,</span>\n    alignItems<span class=\"token operator\">:</span> <span class=\"token string\">\"center\"</span><span class=\"token punctuation\">,</span>\n    justifyContent<span class=\"token operator\">:</span> <span class=\"token string\">\"center\"</span><span class=\"token punctuation\">,</span>\n    backgroundColor<span class=\"token operator\">:</span> <span class=\"token string\">\"#5941A9\"</span><span class=\"token punctuation\">,</span>\n    height<span class=\"token operator\">:</span> <span class=\"token number\">40</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  label<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    fontSize<span class=\"token operator\">:</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span>\n    fontWeight<span class=\"token operator\">:</span> <span class=\"token string\">\"800\"</span><span class=\"token punctuation\">,</span>\n    letterSpacing<span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n    textTransform<span class=\"token operator\">:</span> <span class=\"token string\">\"uppercase\"</span><span class=\"token punctuation\">,</span>\n    color<span class=\"token operator\">:</span> <span class=\"token string\">\"#fff\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<ul>\n<li>Basically, all we are doing is creating a button (<code class=\"language-text\">Pressable</code>) that will naviagte us to the payment screen.</li>\n</ul>\n<p>Before we create the next screen, letâ€™s create some navigation so that we will actually be able to navigate to that screen.<br>\nCreate <code class=\"language-text\">src > utils > Navigation.js</code>. Edit <code class=\"language-text\">Navigation.js</code> to look like the following:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// Navigation.js</span>\n<span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">\"react\"</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> NavigationContainer <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"@react-navigation/native\"</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> createNativeStackNavigator <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"@react-navigation/native-stack\"</span>\n\n<span class=\"token keyword\">import</span> HomeScreen <span class=\"token keyword\">from</span> <span class=\"token string\">\"../screens/HomeScreen\"</span>\n<span class=\"token keyword\">import</span> CardScreen <span class=\"token keyword\">from</span> <span class=\"token string\">\"../screens/CardScreen\"</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">function</span> <span class=\"token function\">Navigation</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> RootStack <span class=\"token operator\">=</span> <span class=\"token function\">createNativeStackNavigator</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">RootStackScreen</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span>RootStack<span class=\"token punctuation\">.</span>Navigator<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>RootStack<span class=\"token punctuation\">.</span>Screen\n        name<span class=\"token operator\">=</span><span class=\"token string\">\"Home\"</span>\n        component<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>HomeScreen<span class=\"token punctuation\">}</span>\n        options<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> headerShown<span class=\"token operator\">:</span> <span class=\"token boolean\">false</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n      <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>RootStack<span class=\"token punctuation\">.</span>Screen\n        name<span class=\"token operator\">=</span><span class=\"token string\">\"Card\"</span>\n        component<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>CardScreen<span class=\"token punctuation\">}</span>\n        options<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>\n          headerStyle<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> backgroundColor<span class=\"token operator\">:</span> <span class=\"token string\">\"#5941A9\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n          headerTintColor<span class=\"token operator\">:</span> <span class=\"token string\">\"#fff\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n      <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>RootStack<span class=\"token punctuation\">.</span>Navigator<span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span>NavigationContainer<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>RootStackScreen <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>NavigationContainer<span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Change <code class=\"language-text\">App.js</code> to return Navigation instead of HomeScreen.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// App.js</span>\n<span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">\"react\"</span>\n<span class=\"token keyword\">import</span> Navigation <span class=\"token keyword\">from</span> <span class=\"token string\">\"./src/utils/Navigation\"</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">function</span> <span class=\"token function\">App</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>Navigation <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Now that we can navigate between screens, letâ€™s create our <code class=\"language-text\">CardScreen.js</code>. This will handle our payment logic and will be where our stripe implementation will be.</p>\n<p><code class=\"language-text\">CardScreen.js</code></p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// CardScreen.js</span>\n<span class=\"token keyword\">import</span> React<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> useState <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"react\"</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> View<span class=\"token punctuation\">,</span> Text<span class=\"token punctuation\">,</span> TextInput<span class=\"token punctuation\">,</span> Pressable<span class=\"token punctuation\">,</span> StyleSheet <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"react-native\"</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> CardField <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"@stripe/stripe-react-native\"</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">function</span> <span class=\"token function\">CardScreen</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>name<span class=\"token punctuation\">,</span> setName<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>cardFocused<span class=\"token punctuation\">,</span> setCardFocused<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>nameFocused<span class=\"token punctuation\">,</span> setNameFocused<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">handlePayPress</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Todo: handlePayPress\"</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span>View style<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>styles<span class=\"token punctuation\">.</span>container<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>Text<span class=\"token operator\">></span>Card<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Text<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>TextInput\n        style<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">[</span>styles<span class=\"token punctuation\">.</span>input<span class=\"token punctuation\">,</span> nameFocused <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">{</span> borderBottomColor<span class=\"token operator\">:</span> <span class=\"token string\">\"#5941A9\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span>\n        placeholder<span class=\"token operator\">=</span><span class=\"token string\">\"Name\"</span>\n        placeholderTextColor<span class=\"token operator\">=</span><span class=\"token string\">\"#B8B8B8\"</span>\n        onChangeText<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>setName<span class=\"token punctuation\">}</span>\n        value<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>name<span class=\"token punctuation\">}</span>\n        keyboardType<span class=\"token operator\">=</span><span class=\"token string\">\"default\"</span>\n        onFocus<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n          <span class=\"token function\">setNameFocused</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n        onBlur<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n          <span class=\"token function\">setNameFocused</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n      <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>CardField\n        postalCodeEnabled<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">}</span>\n        style<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">[</span>styles<span class=\"token punctuation\">.</span>cardField<span class=\"token punctuation\">,</span> cardFocused <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">{</span> borderColor<span class=\"token operator\">:</span> <span class=\"token string\">\"#5941A9\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span>\n        cardStyle<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> textColor<span class=\"token operator\">:</span> <span class=\"token string\">\"#fff\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n        onFocus<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token parameter\">focusedField</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n          console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"focusField\"</span><span class=\"token punctuation\">,</span> focusedField<span class=\"token punctuation\">)</span>\n          <span class=\"token function\">setCardFocused</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n        onBlur<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n          <span class=\"token function\">setCardFocused</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n      <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>Pressable style<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>styles<span class=\"token punctuation\">.</span>button<span class=\"token punctuation\">}</span> onPress<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>handlePayPress<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>Text style<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>styles<span class=\"token punctuation\">.</span>label<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>Pay<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Text<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Pressable<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>View<span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> styles <span class=\"token operator\">=</span> StyleSheet<span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  container<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    backgroundColor<span class=\"token operator\">:</span> <span class=\"token string\">\"#141414\"</span><span class=\"token punctuation\">,</span>\n    flex<span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n    paddingHorizontal<span class=\"token operator\">:</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  cardField<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    height<span class=\"token operator\">:</span> <span class=\"token number\">50</span><span class=\"token punctuation\">,</span>\n    borderColor<span class=\"token operator\">:</span> <span class=\"token string\">\"#2F2258\"</span><span class=\"token punctuation\">,</span>\n    borderWidth<span class=\"token operator\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span>\n    borderRadius<span class=\"token operator\">:</span> <span class=\"token number\">8</span><span class=\"token punctuation\">,</span>\n    marginVertical<span class=\"token operator\">:</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  text<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    color<span class=\"token operator\">:</span> <span class=\"token string\">\"#fff\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  button<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    borderRadius<span class=\"token operator\">:</span> <span class=\"token number\">8</span><span class=\"token punctuation\">,</span>\n    width<span class=\"token operator\">:</span> <span class=\"token number\">150</span><span class=\"token punctuation\">,</span>\n    padding<span class=\"token operator\">:</span> <span class=\"token number\">8</span><span class=\"token punctuation\">,</span>\n    alignItems<span class=\"token operator\">:</span> <span class=\"token string\">\"center\"</span><span class=\"token punctuation\">,</span>\n    justifyContent<span class=\"token operator\">:</span> <span class=\"token string\">\"center\"</span><span class=\"token punctuation\">,</span>\n    backgroundColor<span class=\"token operator\">:</span> <span class=\"token string\">\"#5941A9\"</span><span class=\"token punctuation\">,</span>\n    height<span class=\"token operator\">:</span> <span class=\"token number\">40</span><span class=\"token punctuation\">,</span>\n    alignSelf<span class=\"token operator\">:</span> <span class=\"token string\">\"center\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  label<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    fontSize<span class=\"token operator\">:</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span>\n    fontWeight<span class=\"token operator\">:</span> <span class=\"token string\">\"800\"</span><span class=\"token punctuation\">,</span>\n    letterSpacing<span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n    textTransform<span class=\"token operator\">:</span> <span class=\"token string\">\"uppercase\"</span><span class=\"token punctuation\">,</span>\n    color<span class=\"token operator\">:</span> <span class=\"token string\">\"#fff\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  input<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    color<span class=\"token operator\">:</span> <span class=\"token string\">\"#fff\"</span><span class=\"token punctuation\">,</span>\n    borderBottomColor<span class=\"token operator\">:</span> <span class=\"token string\">\"#2F2258\"</span><span class=\"token punctuation\">,</span>\n    borderBottomWidth<span class=\"token operator\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span>\n    height<span class=\"token operator\">:</span> <span class=\"token number\">40</span><span class=\"token punctuation\">,</span>\n    fontSize<span class=\"token operator\">:</span> <span class=\"token number\">17</span><span class=\"token punctuation\">,</span>\n    letterSpacing<span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n    paddingHorizontal<span class=\"token operator\">:</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<ul>\n<li><code class=\"language-text\">CardField</code> is a component that comes from Stripe. Stripe gives us access to these components with built in UI so we donâ€™t have to do that part.</li>\n</ul>\n<p>Now we just need to be able to navigate to our <code class=\"language-text\">CardScreen.js</code> from <code class=\"language-text\">HomeScreen.js</code>\nModify <code class=\"language-text\">HomeScreen.js</code> by adding the <code class=\"language-text\">navigation</code> prop and changing the onPress function to navigate to the Card screen:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// HomeScreen.js</span>\n<span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">\"react\"</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> View<span class=\"token punctuation\">,</span> Text<span class=\"token punctuation\">,</span> StatusBar<span class=\"token punctuation\">,</span> Pressable<span class=\"token punctuation\">,</span> StyleSheet <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"react-native\"</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">function</span> <span class=\"token function\">HomeScreen</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> navigation <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span>View style<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>styles<span class=\"token punctuation\">.</span>container<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>StatusBar barStyle<span class=\"token operator\">=</span><span class=\"token string\">\"light-content\"</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>Pressable\n        style<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>styles<span class=\"token punctuation\">.</span>button<span class=\"token punctuation\">}</span>\n        onPress<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> navigation<span class=\"token punctuation\">.</span><span class=\"token function\">navigate</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Card\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span>\n      <span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>Text style<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>styles<span class=\"token punctuation\">.</span>label<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>Buy<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Text<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Pressable<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>View<span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> styles <span class=\"token operator\">=</span> StyleSheet<span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  container<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    flex<span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n    alignItems<span class=\"token operator\">:</span> <span class=\"token string\">\"center\"</span><span class=\"token punctuation\">,</span>\n    justifyContent<span class=\"token operator\">:</span> <span class=\"token string\">\"center\"</span><span class=\"token punctuation\">,</span>\n    backgroundColor<span class=\"token operator\">:</span> <span class=\"token string\">\"#141414\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  button<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    borderRadius<span class=\"token operator\">:</span> <span class=\"token number\">8</span><span class=\"token punctuation\">,</span>\n    width<span class=\"token operator\">:</span> <span class=\"token number\">150</span><span class=\"token punctuation\">,</span>\n    padding<span class=\"token operator\">:</span> <span class=\"token number\">8</span><span class=\"token punctuation\">,</span>\n    alignItems<span class=\"token operator\">:</span> <span class=\"token string\">\"center\"</span><span class=\"token punctuation\">,</span>\n    justifyContent<span class=\"token operator\">:</span> <span class=\"token string\">\"center\"</span><span class=\"token punctuation\">,</span>\n    backgroundColor<span class=\"token operator\">:</span> <span class=\"token string\">\"#5941A9\"</span><span class=\"token punctuation\">,</span>\n    height<span class=\"token operator\">:</span> <span class=\"token number\">40</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  label<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    fontSize<span class=\"token operator\">:</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span>\n    fontWeight<span class=\"token operator\">:</span> <span class=\"token string\">\"800\"</span><span class=\"token punctuation\">,</span>\n    letterSpacing<span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n    textTransform<span class=\"token operator\">:</span> <span class=\"token string\">\"uppercase\"</span><span class=\"token punctuation\">,</span>\n    color<span class=\"token operator\">:</span> <span class=\"token string\">\"#fff\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Now we should be able to naviagte between the two screens. We still have to implement Stripe, but that will be the next step. Make sure your app is funcitonal before moving on. This is what it should look like:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 600px; margin-bottom: 2rem\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/f5c25fc00252e12030b9d26eeaeac188/0a47e/home.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 216.45569620253164%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAArCAYAAAB4pah1AAAACXBIWXMAAAsTAAALEwEAmpwYAAABSklEQVRIx+1XvUrEQBjcF1DJZrPJnRuUFKY5EazEdKtgCjltPU4QzANY3ktYaCOCb6CNNja+28i3dzmSwOYHbZQtht395vuGXQgzhHmehyRJoLVGlmXgnEMIYYXv++s99aZpijzPURQFoigCKxvCMISUsjbQJtjso1laWUmWqJ77iDbBmoNdN+zqY32Gh8AJOkEn+I8Fl04StKKX21R9kPMteHxjhc0VlmfibL5pvaEa7WFXHWBnex8qnCCOJmZPNeJ6+2H53POje8z1O+anb1jcfuHu6hMz/Yrrkw/D2Z7NbE6sDxe4zJ5wkT3iZvqC2dkzpscPpkaczbWZPYAkpBxDBiNwL4TPI7OXwdhwtrBi7QHEDYTg8AVfn21iHZ+NCykn6ASd4B9NvV+wr3rqcdA/DK1VlLXBqUc/MXEcQylVA9WIG2SwPxH8Bqr0Nnd9rCtfAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Home screen screenshot\"\n        title=\"Home screen screenshot\"\n        src=\"/static/f5c25fc00252e12030b9d26eeaeac188/0a47e/home.png\"\n        srcset=\"/static/f5c25fc00252e12030b9d26eeaeac188/c26ae/home.png 158w,\n/static/f5c25fc00252e12030b9d26eeaeac188/6bdcf/home.png 315w,\n/static/f5c25fc00252e12030b9d26eeaeac188/0a47e/home.png 600w\"\n        sizes=\"(max-width: 600px) 100vw, 600px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 600px; margin-bottom: 2rem\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/96b88a04ba48fe0703b5db6014036f5e/0a47e/card.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 216.45569620253164%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAArCAYAAAB4pah1AAAACXBIWXMAAAsTAAALEwEAmpwYAAACpklEQVRIx+2Wy08TURTGZ2+wM3Mf82qlD1KZESSghPDQUgJphAgYLLSUSqDiI240xIQFGzfuhWiUPwDQBEhcoEgMKxMX/k+fubetbadtINGdXfxy7pzvnG/OmdlcZSGxj8LUITYKJ1jPHyOT2Ec2+VGSGa2cG+XE+dHMETafnuLNqx/IjX+CMp/Yw/ztXSwk9pBJ7iMzuldH+tYu0iO79VqyErNjxV7l2f1jvFg8wfrSNxSmPiM7eoDc2CFyYwdYTB4gP36Il8un2Fj9jgcTRzInND+Lpaikk++QnXiP/J0dzCXe4u7gFqaHtktsYWZoG7nUB+QndzA7vI3pGr0ehegG1MsUWoCDUQsGd2AwpxhLZ0osEN0CZ3Yl3wTFcWx4XqfENA3ougpCdBCiVaGDUH+uMYpp2IhGOiSW6YBRE5yZMjJWgVfBfPqfPDWgiDV1zQDRTbkyldEurl1FcW0TlIjmWk3UC51TC4rJQwiHo7CtoJwwFovDcUKghIMxQ75VxHB7FB2xOCLhGAxugVFe1KiBoHNFelhGSKwchOu5CAaDsG0bvb29iEQj0DQdjDLQEq7roa/vBuLxq+Ccl74rkTESicLzXDhWOxTx55gc15aji78uVycUuq7LBhFVVUUgEICqBkAIlWuXKX8quTIhBJRSHwQ98VkMdT/GYFcBIz1rGL6+hsGuhxjufiI10efvFc9K+VCdpJTj3sgOVlNnWEl9xevnv7C59hPL419QSJ1JTdTU99GioR8hdndMYuDaCvrdJdzszKPfzcvzgLcitcab+QzLRSKqWhtU7VIT2mpqmxrWFrBzoA2nbLjy39AybBm2DFuGLcOW4X9u2OxWcJGauptDuVDcuDRNk7Gacs5ff+6EpmkiFArJe2M1Iie0C034Lwx/A80wjUZq7jcNAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Card screen screenshot\"\n        title=\"Card screen screenshot\"\n        src=\"/static/96b88a04ba48fe0703b5db6014036f5e/0a47e/card.png\"\n        srcset=\"/static/96b88a04ba48fe0703b5db6014036f5e/c26ae/card.png 158w,\n/static/96b88a04ba48fe0703b5db6014036f5e/6bdcf/card.png 315w,\n/static/96b88a04ba48fe0703b5db6014036f5e/0a47e/card.png 600w\"\n        sizes=\"(max-width: 600px) 100vw, 600px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h2>Create a server for stripe</h2>\n<p>We need to create a server that stripe will use so we can communicate between stripe and our react native app.</p>\n<p>Create a new folder called <code class=\"language-text\">server</code>. Navigate to the folder and run <code class=\"language-text\">$ npm init -y</code>. After itâ€™s set-up, run <code class=\"language-text\">$ npm i express body-parser dotenv</code>.</p>\n<p>We also need to install stripe. <code class=\"language-text\">$ npm install stripe --save</code>.</p>\n<p>Create <code class=\"language-text\">server/server.js</code> and add this into it:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> express <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"express\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> app <span class=\"token operator\">=</span> <span class=\"token function\">express</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> resolve <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"path\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">// Replace if using a different env file or config</span>\n<span class=\"token keyword\">const</span> env <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"dotenv\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">config</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> path<span class=\"token operator\">:</span> <span class=\"token string\">\"./.env\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">const</span> stripe <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"stripe\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">STRIPE_SECRET_KEY</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n  apiVersion<span class=\"token operator\">:</span> <span class=\"token string\">\"2020-08-27\"</span><span class=\"token punctuation\">,</span>\n  appInfo<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// For sample support and debugging, not required for production:</span>\n    name<span class=\"token operator\">:</span> <span class=\"token string\">\"stripe-samples/accept-a-payment/custom-payment-flow\"</span><span class=\"token punctuation\">,</span>\n    version<span class=\"token operator\">:</span> <span class=\"token string\">\"0.0.2\"</span><span class=\"token punctuation\">,</span>\n    url<span class=\"token operator\">:</span> <span class=\"token string\">\"https://github.com/stripe-samples\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\napp<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span>express<span class=\"token punctuation\">.</span><span class=\"token function\">static</span><span class=\"token punctuation\">(</span>process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">STATIC_DIR</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\napp<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span>\n  express<span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// We need the raw body to verify webhook signatures.</span>\n    <span class=\"token comment\">// Let's compute it only when hitting the Stripe webhook endpoint.</span>\n    <span class=\"token function-variable function\">verify</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> res<span class=\"token punctuation\">,</span> buf</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>req<span class=\"token punctuation\">.</span>originalUrl<span class=\"token punctuation\">.</span><span class=\"token function\">startsWith</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/webhook\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        req<span class=\"token punctuation\">.</span>rawBody <span class=\"token operator\">=</span> buf<span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span>\n\napp<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> res</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> path <span class=\"token operator\">=</span> <span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">STATIC_DIR</span> <span class=\"token operator\">+</span> <span class=\"token string\">\"/index.html\"</span><span class=\"token punctuation\">)</span>\n  res<span class=\"token punctuation\">.</span><span class=\"token function\">sendFile</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\napp<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/config\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> res</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Request /config</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n  res<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    publishableKey<span class=\"token operator\">:</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">STRIPE_PUBLISHABLE_KEY</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\napp<span class=\"token punctuation\">.</span><span class=\"token function\">post</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/create-payment-intent\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> res</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> paymentMethodType<span class=\"token punctuation\">,</span> currency <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> req<span class=\"token punctuation\">.</span>body\n\n  <span class=\"token comment\">// Each payment method type has support for different currencies. In order to</span>\n  <span class=\"token comment\">// support many payment method types and several currencies, this server</span>\n  <span class=\"token comment\">// endpoint accepts both the payment method type and the currency as</span>\n  <span class=\"token comment\">// parameters.</span>\n  <span class=\"token comment\">//</span>\n  <span class=\"token comment\">// Some example payment method types include `card`, `ideal`, and `alipay`.</span>\n  <span class=\"token keyword\">const</span> params <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    payment_method_types<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>paymentMethodType<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    amount<span class=\"token operator\">:</span> <span class=\"token number\">1999</span><span class=\"token punctuation\">,</span>\n    currency<span class=\"token operator\">:</span> currency<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">// If this is for an ACSS payment, we add payment_method_options to create</span>\n  <span class=\"token comment\">// the Mandate.</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>paymentMethodType <span class=\"token operator\">===</span> <span class=\"token string\">\"acss_debit\"</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    params<span class=\"token punctuation\">.</span>payment_method_options <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n      acss_debit<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        mandate_options<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n          payment_schedule<span class=\"token operator\">:</span> <span class=\"token string\">\"sporadic\"</span><span class=\"token punctuation\">,</span>\n          transaction_type<span class=\"token operator\">:</span> <span class=\"token string\">\"personal\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">// Create a PaymentIntent with the amount, currency, and a payment method type.</span>\n  <span class=\"token comment\">//</span>\n  <span class=\"token comment\">// See the documentation [0] for the full list of supported parameters.</span>\n  <span class=\"token comment\">//</span>\n  <span class=\"token comment\">// [0] https://stripe.com/docs/api/payment_intents/create</span>\n  <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> paymentIntent <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> stripe<span class=\"token punctuation\">.</span>paymentIntents<span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span>params<span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\">// Send publishable key and PaymentIntent details to client</span>\n    res<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      clientSecret<span class=\"token operator\">:</span> paymentIntent<span class=\"token punctuation\">.</span>client_secret<span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> res<span class=\"token punctuation\">.</span><span class=\"token function\">status</span><span class=\"token punctuation\">(</span><span class=\"token number\">400</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      error<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        message<span class=\"token operator\">:</span> e<span class=\"token punctuation\">.</span>message<span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\napp<span class=\"token punctuation\">.</span><span class=\"token function\">listen</span><span class=\"token punctuation\">(</span><span class=\"token number\">3000</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Node server listening at http://localhost:3000</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span></code></pre></div>\n<ul>\n<li>This gives us access to the endpoints that we need to interact with stripe in our app.</li>\n</ul>\n<p>Now we need to create a <code class=\"language-text\">.env</code> file inside of the <code class=\"language-text\">server</code> directory. Fill in the values for <code class=\"language-text\">STRIPE_SECRET_KEY</code>, <code class=\"language-text\">PRICE</code>, <code class=\"language-text\">STRIPE_PUBLISHABLE_KEY</code>. For <code class=\"language-text\">PRICE</code> we need to add a product to our stripe dashboard. We do this so all our data is safe in stripe and no one can hack the network request and change the price/amount that we charge someone.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">STRIPE_SECRET_KEY=secret_key\nSTATIC_DIR=../\nPRICE=price_id\nDOMAIN=http://127.0.0.1:3000\nSTRIPE_PUBLISHABLE_KEY=publishable_key</code></pre></div>\n<h2>Implement Stripe</h2>\n<p>Now that we have our app built out, we need to integrate stripe into our application so we can make payments to stripe.</p>\n<p>Modify <code class=\"language-text\">App.js</code></p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> React<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> useState<span class=\"token punctuation\">,</span> useEffect <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"react\"</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> StripeProvider <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"@stripe/stripe-react-native\"</span>\n\n<span class=\"token keyword\">import</span> Navigation <span class=\"token keyword\">from</span> <span class=\"token string\">\"./src/utils/Navigation\"</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> fetchPublishableKey <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"/src/utils/helpers\"</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">function</span> <span class=\"token function\">App</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>publishableKey<span class=\"token punctuation\">,</span> setPublishableKey<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">init</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">const</span> publishableKey <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">fetchPublishableKey</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>publishableKey<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">setPublishableKey</span><span class=\"token punctuation\">(</span>publishableKey<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token function\">init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span>StripeProvider publishableKey<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>publishableKey<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>Navigation <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>StripeProvider<span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li><code class=\"language-text\">StripeProvider</code> initializes stripe in our react native application.</li>\n<li><code class=\"language-text\">publishableKey</code> is where we will store our publishable key.</li>\n<li><code class=\"language-text\">fetchPublishableKey()</code> is a method that will get our publishable key from our stripe server. We havenâ€™t created the method yet.</li>\n</ul>\n<p>Create <code class=\"language-text\">fetchPublishableKey()</code> in <code class=\"language-text\">src/utils/helper.js</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> <span class=\"token constant\">API_URL</span> <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"../config/StripeConfig\"</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">fetchPublishableKey</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> response <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token constant\">API_URL</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/config</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> publishableKey <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> response<span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> publishableKey\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">warn</span><span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span>\n    <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Error fetching publishable key.\"</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li><code class=\"language-text\">API_URL</code> is the url of our api. We will create this next.</li>\n<li><code class=\"language-text\">fetchPublishableKey()</code> just makes a get request to our stripe server and the stripe server responds with our publishable key.</li>\n</ul>\n<p>Create <code class=\"language-text\">StripeConfig.js</code> in <code class=\"language-text\">src/config/StripeConfig.js</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Platform <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"react-native\"</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token constant\">API_URL</span> <span class=\"token operator\">=</span>\n  Platform<span class=\"token punctuation\">.</span><span class=\"token constant\">OS</span> <span class=\"token operator\">===</span> <span class=\"token string\">\"android\"</span> <span class=\"token operator\">?</span> <span class=\"token string\">\"http://10.0.0.2:4242\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"http://127.0.0.1:3000\"</span></code></pre></div>\n<p>Now we need to edit <code class=\"language-text\">CardScreen.js</code></p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> CardField<span class=\"token punctuation\">,</span> useConfirmPayment <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"@stripe/stripe-react-native\"</span>\n<span class=\"token keyword\">import</span> React<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> useState <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"react\"</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> View<span class=\"token punctuation\">,</span> Text<span class=\"token punctuation\">,</span> StyleSheet<span class=\"token punctuation\">,</span> Pressable<span class=\"token punctuation\">,</span> TextInput <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"react-native\"</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> <span class=\"token constant\">API_URL</span> <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"../config/StripeConfig\"</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">function</span> <span class=\"token function\">Card</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>name<span class=\"token punctuation\">,</span> setName<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> confirmPayment<span class=\"token punctuation\">,</span> loading <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">useConfirmPayment</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>cardFocused<span class=\"token punctuation\">,</span> setCardFocused<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>nameFocused<span class=\"token punctuation\">,</span> setNameFocused<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">handlePayPress</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> response <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token constant\">API_URL</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/create-payment-intent</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n      method<span class=\"token operator\">:</span> <span class=\"token string\">\"POST\"</span><span class=\"token punctuation\">,</span>\n      headers<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token string\">\"Content-Type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"application/json\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n      body<span class=\"token operator\">:</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n        paymentMethodType<span class=\"token operator\">:</span> <span class=\"token string\">\"card\"</span><span class=\"token punctuation\">,</span>\n        currency<span class=\"token operator\">:</span> <span class=\"token string\">\"usd\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> clientSecret <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> response<span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> error<span class=\"token punctuation\">,</span> paymentIntent <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">confirmPayment</span><span class=\"token punctuation\">(</span>clientSecret<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n      type<span class=\"token operator\">:</span> <span class=\"token string\">\"Card\"</span><span class=\"token punctuation\">,</span>\n      billingDetails<span class=\"token operator\">:</span> name<span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Error: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>error<span class=\"token punctuation\">.</span>code<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>error<span class=\"token punctuation\">.</span>message<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>paymentIntent<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Payment successful: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>paymentIntent<span class=\"token punctuation\">.</span>id<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span>View style<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>styles<span class=\"token punctuation\">.</span>container<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>Text<span class=\"token operator\">></span>Card<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Text<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>TextInput\n        style<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">[</span>styles<span class=\"token punctuation\">.</span>input<span class=\"token punctuation\">,</span> nameFocused <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">{</span> borderBottomColor<span class=\"token operator\">:</span> <span class=\"token string\">\"#5941A9\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span>\n        placeholder<span class=\"token operator\">=</span><span class=\"token string\">\"Name\"</span>\n        placeholderTextColor<span class=\"token operator\">=</span><span class=\"token string\">\"#B8B8B8\"</span>\n        onChangeText<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>setName<span class=\"token punctuation\">}</span>\n        value<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>name<span class=\"token punctuation\">}</span>\n        keyboardType<span class=\"token operator\">=</span><span class=\"token string\">\"default\"</span>\n        onFocus<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n          <span class=\"token function\">setNameFocused</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n        onBlur<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n          <span class=\"token function\">setNameFocused</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n      <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>CardField\n        postalCodeEnabled<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">}</span>\n        style<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">[</span>styles<span class=\"token punctuation\">.</span>cardField<span class=\"token punctuation\">,</span> cardFocused <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">{</span> borderColor<span class=\"token operator\">:</span> <span class=\"token string\">\"#5941A9\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span>\n        cardStyle<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> textColor<span class=\"token operator\">:</span> <span class=\"token string\">\"#fff\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n        <span class=\"token comment\">// onCardChange={cardDetails => setCard(cardDetails)}</span>\n        onFocus<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token parameter\">focusedField</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n          console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"focusField\"</span><span class=\"token punctuation\">,</span> focusedField<span class=\"token punctuation\">)</span>\n          <span class=\"token function\">setCardFocused</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n        onBlur<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n          <span class=\"token function\">setCardFocused</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n      <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>Pressable\n        style<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>styles<span class=\"token punctuation\">.</span>button<span class=\"token punctuation\">}</span>\n        onPress<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>handlePayPress<span class=\"token punctuation\">}</span>\n        disabled<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>loading<span class=\"token punctuation\">}</span>\n      <span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>Text style<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>styles<span class=\"token punctuation\">.</span>label<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>Pay<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Text<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Pressable<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>View<span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> styles <span class=\"token operator\">=</span> StyleSheet<span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  container<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    backgroundColor<span class=\"token operator\">:</span> <span class=\"token string\">\"#141414\"</span><span class=\"token punctuation\">,</span>\n    flex<span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n    paddingHorizontal<span class=\"token operator\">:</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  cardField<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    height<span class=\"token operator\">:</span> <span class=\"token number\">50</span><span class=\"token punctuation\">,</span>\n    borderColor<span class=\"token operator\">:</span> <span class=\"token string\">\"#2F2258\"</span><span class=\"token punctuation\">,</span>\n    borderWidth<span class=\"token operator\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span>\n    borderRadius<span class=\"token operator\">:</span> <span class=\"token number\">8</span><span class=\"token punctuation\">,</span>\n    marginVertical<span class=\"token operator\">:</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  text<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    color<span class=\"token operator\">:</span> <span class=\"token string\">\"#fff\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  button<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    borderRadius<span class=\"token operator\">:</span> <span class=\"token number\">8</span><span class=\"token punctuation\">,</span>\n    width<span class=\"token operator\">:</span> <span class=\"token number\">150</span><span class=\"token punctuation\">,</span>\n    padding<span class=\"token operator\">:</span> <span class=\"token number\">8</span><span class=\"token punctuation\">,</span>\n    alignItems<span class=\"token operator\">:</span> <span class=\"token string\">\"center\"</span><span class=\"token punctuation\">,</span>\n    justifyContent<span class=\"token operator\">:</span> <span class=\"token string\">\"center\"</span><span class=\"token punctuation\">,</span>\n    backgroundColor<span class=\"token operator\">:</span> <span class=\"token string\">\"#5941A9\"</span><span class=\"token punctuation\">,</span>\n    height<span class=\"token operator\">:</span> <span class=\"token number\">40</span><span class=\"token punctuation\">,</span>\n    alignSelf<span class=\"token operator\">:</span> <span class=\"token string\">\"center\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  label<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    fontSize<span class=\"token operator\">:</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span>\n    fontWeight<span class=\"token operator\">:</span> <span class=\"token string\">\"800\"</span><span class=\"token punctuation\">,</span>\n    letterSpacing<span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n    textTransform<span class=\"token operator\">:</span> <span class=\"token string\">\"uppercase\"</span><span class=\"token punctuation\">,</span>\n    color<span class=\"token operator\">:</span> <span class=\"token string\">\"#fff\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  input<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    color<span class=\"token operator\">:</span> <span class=\"token string\">\"#fff\"</span><span class=\"token punctuation\">,</span>\n    borderBottomColor<span class=\"token operator\">:</span> <span class=\"token string\">\"#2F2258\"</span><span class=\"token punctuation\">,</span>\n    borderBottomWidth<span class=\"token operator\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span>\n    height<span class=\"token operator\">:</span> <span class=\"token number\">40</span><span class=\"token punctuation\">,</span>\n    fontSize<span class=\"token operator\">:</span> <span class=\"token number\">17</span><span class=\"token punctuation\">,</span>\n    letterSpacing<span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n    paddingHorizontal<span class=\"token operator\">:</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<ul>\n<li>We are importing <code class=\"language-text\">useConfirmPayment</code> which gives us <code class=\"language-text\">confirmPayment()</code> method to confirm the payment, and <code class=\"language-text\">loading</code> variable so we know when stripe is done.\n<ul>\n<li><code class=\"language-text\">const {confirmPayment, loading} = useConfirmPayment();</code></li>\n</ul>\n</li>\n<li>In <code class=\"language-text\">handlePayPress()</code> we make a request to <code class=\"language-text\">/create-payment-intent</code> and give the <code class=\"language-text\">paymentMethodType</code> and <code class=\"language-text\">currency</code></li>\n<li>In resposne, we get <code class=\"language-text\">clientSecret</code></li>\n<li>Then we can call <code class=\"language-text\">confirmPayment()</code> and pass in <code class=\"language-text\">clientSecret</code> and an object with <code class=\"language-text\">type</code> and <code class=\"language-text\">billingDetails</code></li>\n<li>Finally we can see if the payment was successful!</li>\n</ul>\n<h2>Run the app</h2>\n<p>Now we can run the app!</p>\n<ol>\n<li>Start the stripe server: <code class=\"language-text\">node server.js</code></li>\n<li>Run react native app: <code class=\"language-text\">react-native run-ios</code></li>\n<li>Click on Buy</li>\n<li>Fill in the name and card details</li>\n<li>Click Pay</li>\n</ol>\n<p>Finally you should get an alert that the payment was successful!</p>","timeToRead":13,"frontmatter":{"title":"How to integrate Stripe in a react native application","date":"September 12, 2021","description":"Stripe is one of the biggest payment gateways. Learn how to integrate stripe into a react-native application with this how-to guide.","tags":["javascript","react-native","stripe"]}},"previous":null,"next":{"fields":{"slug":"articles/09-17-2021_Deploy-gatsby-on-github-pages/"},"frontmatter":{"title":"How to deploy a gatsby site with github pages"}}},"pageContext":{"id":"2dc7263f-d78d-54a7-a1df-25f2dc5d1402","previousPostId":null,"nextPostId":"799c7cd2-bf42-5cf2-a4e6-a71629d1a6c7"}},
    "staticQueryHashes": ["2841359383","3257411868"]}